#!/bin/bash


#Buscamos el parametro para saber si es texto o no
if [ "$1" = "--texto" ]; then
  texto="1"
  ptexto="--texto"
else
  texto="0"
  ptexto="--dialog"
fi

function mensaje() {
   if [ ! -e /usr/bin/dialog -o $texto = 1 ]; then
      echo -e "$1"
   else
      dialog --title "Desinstalación de BulmaGés v 0.4.9" --backtitle "Asociación Iglues" --msgbox "$1" 10 60
   fi
}


function info() {
   if [ ! -e /usr/bin/dialog -o $texto = 1 ]; then
      echo -e "$1"
   else
      dialog  --title "Desinstalación de BulmaGés v 0.4.9" --backtitle "Asociación Iglues" --infobox "$1" 10 60
   fi
}


function tiempo {
  sleep 1.5
}

info "BulmaGés esta siendo desinstalado"
tiempo
su postgres -c "dropdb bulmages" > /dev/null 2> /dev/null
su postgres -c "dropdb bgplangcont"  > /dev/null 2> /dev/null
su postgres -c "dropdb bulmafact" > /dev/null 2> /dev/null
rm /etc/bulmages.conf
rm -rf /usr/share/bulmages
rm -rf /var/www/bcontaweb
rm -rf /usr/bin/bulmages
rm -rf /usr/bin/cargaemp
rm -rf /usr/bin/guardaemp
rm -rf /usr/bin/nuevaemp
rm -rf /usr/bin/bulmafact
rm -rf /usr/bin/bulmacont
rm -rf /usr/bin/bulmatpv

rmdir -rf /usr/share/bulmages
rmdir -rf /usr/lib/bulmages

mensaje "BulmaGés ha sido completamente desinstalado.
Puede que queden bases de datos en su ordenador que deberá borrar manualmente."
clear
