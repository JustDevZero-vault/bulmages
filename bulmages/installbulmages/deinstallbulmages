#!/bin/bash


#Buscamos el parametro para saber si es texto o no
if [ "$1" = "--texto" ]; then
  texto="1"
  ptexto="--texto"
else
  texto="0"
  ptexto="--dialog"
fi

function mensaje() {
   if [ ! -e /usr/bin/dialog -o $texto = 1 ]; then
      echo -e "$1"
   else
      dialog --title "Desinstalacion de BulmaGes v4.1" --backtitle "Asociación Iglues" --msgbox "$1" 10 60
   fi
}


function info() {
   if [ ! -e /usr/bin/dialog -o $texto = 1 ]; then
      echo -e "$1"
   else
      dialog  --title "Desinstalacion de BulmaGes v4.1" --backtitle "Asociación Iglues" --infobox "$1" 10 60
   fi
}


function tiempo {
  sleep 1.5
}

info "BulmaGes esta siendo desinstalado"
tiempo
su postgres -c "dropdb bulmages" > /dev/null 2> /dev/null
su postgres -c "dropdb metabd"  > /dev/null 2> /dev/null
su postgres -c "dropdb bgplangcont"  > /dev/null 2> /dev/null
su postgres -c "dropdb bulmafact" > /dev/null 2> /dev/null
rm /etc/bulmages.conf
rm -rf /usr/share/bulmages
rm -rf /var/www/bcontaweb

mensaje "BulmaGes ha sido completamente desinstalado.
Puede que queden bases de datos en su ordenador que debera borrar manualmente"
clear
